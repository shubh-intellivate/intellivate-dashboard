<style>
  .az-content-label{
    font-size: 13px !important;
  }
  .blur{
    filter: blur(5px);
  }
</style>

<div class="az-content az-content-dashboard">
  <div class="container {{blur}}">
    <div class="az-content-body">
      <div class="az-dashboard-one-title">
        <div>
          <h2 class="az-dashboard-title">Hi Shilpa, welcome back!</h2>
          <p class="az-dashboard-text">CET Dashboard</p>
        </div>
        <div class="az-content-header-right">
        </div>
      </div>

      <div class="az-dashboard-nav">
        <nav class="nav">
          <div class="media">
            <div class="media-body">
              <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;">
                <option value="">2021</option>
              </select>
            </div>
          </div>
          <div class="media">
            <div class="media-body">
                <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;" (change)="globalFilter()" #timeframe>
                  <!-- <option value="">Timeframe</option> -->
                  <option value="annual">Annual</option>Z
                  <!-- <option value="ytd">YTD</option> -->
                  <option value="Q1">Q1</option>
                  <option value="Q2">Q2</option>
                  <option value="Q3">Q3</option>
                  <option value="Q4">Q4</option>
                  <option value="1H">1H</option>
                  <option value="2H">2H</option>
                  <!-- <option value="last_month">Last Month</option> -->
                  <!-- <option value="custom">Custom</option> -->
                </select>
                <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':customDateFilter}">
                  <div class="modal-dialog" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h4 class="modal-title">Custom Date Range</h4>
                      </div>
                      <div class="modal-body">
                        <input matInput [matDatepicker]="picker">
                        <mat-hint>MM/DD/YYYY</mat-hint>
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-danger" 
                                (click)="closeCustomDateFiler()">
                          Close
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
            </div>
          </div>
          <div class="media">
            <div class="media-body">
              <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;" (change)="globalFilter()" #bu>
                <option value="">All BU</option>
                <option value="BU AIPF BU">AIPF</option>
                <option value="BU Display Business">Display</option>
                <option value="BU Smart Mfg.">Smart Mfg.</option>
                <option value="ATSS">ATSS</option>
                <option value="Biz Enablement Service">Biz Enablement Service</option>
                <option value="IT PF">IT PF</option>
                <option value="Digital PF DU">Digital PF DU</option>
                <option value="SA&S -Others">SA&S -Others</option>
              </select>
            </div>
          </div>
          <div class="media">
            <div class="media-body">
              <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;" (change)="globalFilter()" #geo>
                <!-- <option value="">Geo</option> -->
                <option value="">All Branches</option>
                <option value="india">India</option>
                <option value="japan">Japan</option>
                <option value="emea">EMEA</option>
                <!-- <option value="LATAM">LATAM</option> -->
                <option value="usa">USA</option>
                <option value="apac">APAC</option>
                <option value="Australia">Australia</option>
              </select>
            </div>
          </div>
          <div class="media">
            <div class="media-body">
              <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;" (change)="globalFilter()" #currency>
                <!-- <option value="">Currency</option> -->
                <option value="">INR(Mn)</option>
                <!-- <option>Dollar(Mn)</option> -->
              </select>
            </div>
          </div>
        </nav>


        <!-- <nav class="nav">
          <a class="nav-link" routerLink="/"><i class="far fa-save"></i> Save Report</a>
          <a class="nav-link" routerLink="/"><i class="far fa-file-pdf"></i> Export to PDF</a>
          <a class="nav-link" routerLink="/"><i class="far fa-envelope"></i>Send to Email</a>
          <a class="nav-link" routerLink="/"><i class="fas fa-elli psis-h"></i></a>
        </nav> -->
      </div>

      <div class="row row-sm mg-b-20">
        <div class="col-lg-6 mg-t-20 mg-lg-t-0">
          <div class="card card-dashboard-five">
            <div class="card-header row">
              <div class="col-lg-6">
                <h6 class="card-title">Order Overview<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
              </div>
              <div class="col-lg-6">
                <div class="media" style="float: right;">
                  <div class="media-body">
                    <a href="javascript:void(0)" (click)="openPipelineModal()" *ngIf="pipelineClassify">Pipeline</a>&nbsp;&nbsp;&nbsp;&nbsp;
                    <a href="javascript:void(0)" (click)="openFRankModal()" *ngIf="pipelineClassify">F Rank</a>&nbsp;&nbsp;&nbsp;&nbsp;
                    <a href="javascript:void(0)" (click)="createChartGaugeOrder()">Reset</a>&nbsp;&nbsp;&nbsp;&nbsp;
                    <span title="Rank Info" (click)="openOrderInfo()"><i class="fa fa-info-circle fa-3" aria-hidden="true"></i></span>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div id="chart-gauge-order" style="height: 250px;"></div>
            </div>
          </div>
        </div>
        <div class="col-lg-6 mg-t-20 mg-lg-t-0">
          <div class="card card-dashboard-five">
            <div class="card-header row">
              <div class="col-lg-6">
                <h6 class="card-title">Sales Overview<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
              </div>
              <div class="col-lg-6">
                <div class="media" style="float: right;">
                  <div class="media-body">
                    <a href="javascript:void(0)" (click)="openSalesModal()" *ngIf="salesBreakdown">Sales breakdown</a>&nbsp;&nbsp;&nbsp;&nbsp;
                    <a href="javascript:void(0)" (click)="createChartGaugeSales()">Reset</a>&nbsp;&nbsp;&nbsp;&nbsp;
                    <span title="Rank Info" (click)="openSalesInfo()"><i class="fa fa-info-circle fa-3" aria-hidden="true"></i></span>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div id="chart-gauge-sales" style="height: 250px;"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="row row-sm mg-b-20">
        <div class="col-lg-3 mg-t-20 mg-lg-t-0">
          <div class="card card-dashboard-five">
            <div class="card-header row">
              <div class="col-lg-8">
                <h6 class="card-title">Order Conversion<span *ngIf="currentBC">({{currentBC}}BC)</span></h6> 
                <p class="card-text">{{buFilter}}/{{timeFilter}}</p>
                <div class="row">
                  <div class="col-lg-6">
                    <select (change)="toggleOrderConversion()" style="width: 100px;" #toggleOrder>
                      <option>By Amount</option>
                      <option>By Number of Opportunities</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="col-lg-4" [hidden]="orderByAmount">
                <div class="media" style="float: right;">
                  <div class="media-body">
                    <a href="javascript:void(0)" (click)="showOrderOppPercentage()">Reset</a>
                  </div>
                </div>
              </div>
              <div class="col-lg-4" [hidden]="orderByOpp">
                <div class="media" style="float: right;">
                  <div class="media-body">
                    <a href="javascript:void(0)" (click)="showOrderAmtPercentage()">Reset</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body" [hidden]="orderByOpp">
              <div [hidden]="order_amt_graph" id="chart-order-amt" style="height: 317px;"></div>
              <div [hidden]="order_amt_per" style="margin-top:33%;height:241px;text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);cursor: pointer;"><span (click)="showOrderAmtGraph()">{{orderAmtPerValue}}</span>
                <div style="text-align:center; font-weight: 900;font-size: 1rem;color: rgb(70, 121, 167);">
                  (Basis {{actual_timeframe}})
                </div>
              </div>
            </div>
            <div class="card-body" [hidden]="orderByAmount">
              <div [hidden]="order_opp_graph" id="chart-order-opp" style="height: 317px;"></div>
              <div [hidden]="order_opp_per" style="margin-top:33%;height:241px;text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);cursor: pointer;"><span (click)="showOrderOppGraph()">{{orderOppPerValue}}</span>
                <div style="text-align:center; font-weight: 900;font-size: 1rem;color: rgb(70, 121, 167);">
                  (Basis {{actual_timeframe}})
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-3 mg-t-20 mg-lg-t-0">
          <div class="card card-dashboard-five" style="height: 220px;">
            <div class="card-header row">
              <div class="col-lg-12">
                <h6 class="card-title">Projected Conversion rate<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                <p class="card-text">{{buFilter}}/{{timeFilter}}</p>
              </div>
            </div>
            <div class="card-body">
              <div class="az-content-label az-content-label-sm mg-b-15"></div>
              <div style="text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);"><span>{{bidWinRate}}</span></div>
            </div>
          </div>
          <div class="card card-dashboard-five mg-t-20" style="height: 220px;">
            <div class="card-header row">
              <div class="col-lg-12">
                <h6 class="card-title">Orders Won<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                <p class="card-text">{{buFilter}}<br>Values in Million</p>
              </div>
            </div>
            <div class="card-body">
              <div class="az-content-label az-content-label-sm mg-b-15">Last Month ({{ordersBookedMonth}})</div>
              <div style="text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);"><a style="color: rgb(70, 121, 167);" target="_blank" href="{{base_url}}records?bu={{buFilterLink}}&geo=&start_date=&end_date=&currency=&type=&rank=&api_type=order_booked_last_month&timeframe={{timeFilter == 'Annual' ? '' : timeFilter}}">{{ordersBookedLastMonth}}</a></div>
            </div>
          </div>
        </div>
        <div class="col-lg-6 mg-t-20 mg-lg-t-0">
          <div class="row row-sm">
            <div class="col-lg-8 mg-t-20 mg-lg-t-0">
              <div class="card card-dashboard-five">
                <div class="card-header row">
                  <div class="col-lg-12">
                    <h6 class="card-title">Run Rate<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                    <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
                  </div>
                </div>
                <div class="card-body row">
                  <div class="col-lg-4" style="text-align: center;">
                    <div class="az-content-label az-content-label-sm">Current</div>
                    <div style="text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);"><span>{{orderRunRate}}</span></div>
                  </div><div class="col-lg-4" style="text-align: center;">
                    <div class="az-content-label az-content-label-sm">Required</div>
                    <div style="text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);"><span>{{requiredRunRate}}</span></div>
                  </div>
                  <div class="col-lg-4" style="text-align: center;">
                    <div class="az-content-label az-content-label-sm">Estimated</div>
                    <div style="text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);"><span>{{estimatedRunRate}}</span></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-4 mg-t-20 mg-lg-t-0">
              <div class="card card-dashboard-five" style="height: 220px;">
                <div class="card-header row">
                  <div class="col-lg-12">
                    <h6 class="card-title">New Customers Acquired<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                    <p class="card-text">{{buFilter}}/{{timeFilter}}</p>
                  </div>
                </div>
                <div class="card-body">
                  <div style="text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);margin-top: 20px;"><a style="color: rgb(70, 121, 167);" target="_blank" href="{{base_url}}records?bu={{buFilterLink}}&geo=&start_date=&end_date=&currency=&type=&rank=&api_type=new_customer_acquired&timeframe={{timeFilter == 'Annual' ? '' : timeFilter}}">{{newCustomers}}</a></div>
                </div>
              </div>
            </div>
          </div>
          <div class="row row-sm mg-b-20 mg-t-20">
            <div class="col-lg-4 mg-t-20 mg-lg-t-0">
              <div class="card card-dashboard-five" style="height: 220px;">
                <div class="card-header row">
                  <div class="col-lg-12">
                    <h6 class="card-title">Average Order Cycle Time<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                    <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Months</p>
                  </div>
                </div>
                <div class="card-body">
                  <div style="height:72px;text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);"><span>{{avgOrderCycle}}</span></div>
                </div>
              </div>
            </div>
            <div class="col-lg-8 mg-t-20 mg-lg-t-0">
              <div class="card card-dashboard-five" style="height: 220px;">
                <div class="card-header row">
                  <div class="col-lg-12">
                    <h6 class="card-title">Average Order <br>Size<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                    <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
                  </div>
                </div>
                <div class="card-body row">
                  <div class="col-lg-6" style="text-align: center;">
                    <!-- <div class="az-content-label az-content-label-sm">Simple</div> -->
                    <div style="height:72px;text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);"><a style="color: rgb(70, 121, 167);" target="_blank" href="{{base_url}}records?bu={{buFilterLink}}&geo=&start_date=&end_date=&currency=&type=&rank=&api_type=average_order_size&highestValue=0&timeframe={{timeFilter == 'Annual' ? '' : timeFilter}}">{{avgOrderSize}}</a></div>
                  </div>
                  <div class="col-lg-6" style="text-align: center;">
                    <div class="row" style="margin-top: -18px;margin-left:20px;">
                        <div class="az-content-label az-content-label-sm">
                          <div class="row">
                            Max Value
                          </div>
                          <div class="row">
                            <div style="height:25px;text-align:center; font-weight: 900;font-size: 1.5rem;color: rgb(70, 121, 167);">{{maxOrderSizeValue}}</div>
                            <!-- <div style="height:25px;text-align:center; font-weight: 900;font-size: 1.5rem;color: rgb(70, 121, 167);">630</div> -->
                          </div>
                        </div>
                    </div>
                    <div class="row" style="margin-left:20px;">
                      <div class="az-content-label az-content-label-sm">
                        <div class="row">
                          Min Value
                        </div>
                        <div class="row">
                          <div style="height:50px;text-align:center; font-weight: 900;font-size: 1.5rem;color: rgb(70, 121, 167);">{{minOrderSizeValue}}</div>
                          <!-- <div style="height:50px;text-align:center; font-weight: 900;font-size: 1.5rem;color: rgb(70, 121, 167);">0.15</div> -->
                        </div>
                      </div>
                  </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row row-sm mg-b-20">
        <div class="col-lg-3 mg-t-20 mg-lg-t-0">
          <div class="card card-dashboard-five">
            <div class="card-header row">
              <div class="col-lg-6">
                <h6 class="card-title">Say-Do Ratio<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                <p class="card-text">{{buFilter}}/{{timeFilter}}</p>
              </div>
              <div class="col-lg-6">
                <div class="media" style="float: right;">
                  <div class="media-body">
                    <a href="javascript:void(0)" (click)="showPrevYearSaydoValue()">Reset</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="az-content-label az-content-label-sm mg-b-15">Order</div>
              <div [hidden]="prev_year_saydo_order" id="chart-prev-year-saydo-order" style="height: 250px;"></div>
              <div [hidden]="prev_year_saydo_order_value" style="margin-top:30%;height:200px;text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);cursor: pointer;"><span (click)="showLastYearSaydoOrder()" [ngStyle]="sayDoColor(sayDoOrderValue)">{{sayDoOrderValue}}<span *ngIf="sayDoOrderValue">%</span></span>
                <div style="text-align:center; font-weight: 900;font-size: 1rem;color: rgb(70, 121, 167);">
                  (Basis {{actual_timeframe}})
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-3 mg-t-20 mg-lg-t-0">
          <div class="card card-dashboard-five">
            <div class="card-header row">
              <div class="col-lg-6">
                <h6 class="card-title">Say-Do Ratio<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                <p class="card-text">{{buFilter}}/{{timeFilter}}</p>
              </div>
              <div class="col-lg-6">
                <div class="media" style="float: right;">
                  <div class="media-body">
                    <a href="javascript:void(0)" (click)="showCurYearSaydoValue()">Reset</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="az-content-label az-content-label-sm mg-b-15">Sales</div>
              <div [hidden]="cur_year_saydo_order" id="chart-prev-year-saydo-sales" style="height: 250px;"></div>
              <div [hidden]="cur_year_saydo_order_value" style="margin-top:30%;height: 200px;text-align:center; font-weight: 900;font-size: 3rem;color: rgb(70, 121, 167);cursor: pointer;"><span (click)="showCurYearSaydoOrder()" [ngStyle]="sayDoColor(sayDoSalesValue)">{{sayDoSalesValue}}<span *ngIf="sayDoSalesValue">%</span></span>
                <div style="text-align:center; font-weight: 900;font-size: 1rem;color: rgb(70, 121, 167);">
                  (Basis {{actual_timeframe}})
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-6 mg-t-20 mg-lg-t-0">
          <div class="card card-dashboard-five" style="height: 389px;">
            <div class="card-header row">
              <div class="col-lg-6">
                <h6 class="card-title">Order Pipeline Trend<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
                <p class="card-text"></p>
              </div>
              <div class="col-lg-6">
                <div class="media" style="float: right;">
                  <div class="media-body">
                    <!-- <i class="fa fa-filter fa-3" aria-hidden="true"></i> -->
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <!-- <div class="az-content-label az-content-label-sm mg-b-15">Order</div> -->
              <div id="order-trend" style="height: 250px;"></div>
            </div>
          </div>
        </div>
       
      </div>

      <div class="row row-sm mg-b-20">
        <div class="col-lg-12 col-xl-12 mg-t-20 mg-lg-t-0">
          <div class="card card-table-one">
            <div class="row">
              <div class="col-md-12">
                <div style="text-align: center;">
                  <h3 class="card-title" style="font-size: 1rem;">Top 5 Key Projects<span *ngIf="currentBC">({{currentBC}}BC)</span></h3>
                  {{buFilter}}/{{timeFilter}}<br>
                  <select class="" style="border-width: 0px;" (change)="toggleProjects()" #toggleProj>
                    <option value="actual">Actual</option>
                    <option value="open">Open</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="table-responsive">
              <table class="table" style="table-layout: fixed; width: 100%">
                <thead>
                  <tr>
                    <th class="wd-30p">Project</th>
                    <th class="wd-30p">Account</th>
                    <th class="wd-10p" style="text-align: center;">BU</th>
                    <th class="wd-10p">Value(Mn)</th>
                    <th class="wd-10p">Rank</th>
                    <th class="wd-10p" style="text-align: right;">Closing Month</th>
                  </tr>
                </thead>
                <tbody *ngIf="top_key_projects_actuals" [hidden]="hide_project_actuals">
                  <tr>
                    <td><strong>{{top_key_projects_actuals.project_1.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_1.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_actuals.project_1.bu}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_1.amount}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_1.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_actuals.project_1.month}}</strong></td>
                  </tr>
                  <tr>
                    <td><strong>{{top_key_projects_actuals.project_2.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_2.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_actuals.project_2.bu}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_2.amount}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_2.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_actuals.project_2.month}}</strong></td>
                  </tr><tr>
                    <td><strong>{{top_key_projects_actuals.project_3.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_3.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_actuals.project_3.bu}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_3.amount}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_3.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_actuals.project_3.month}}</strong></td>
                  </tr><tr>
                    <td><strong>{{top_key_projects_actuals.project_4.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_4.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_actuals.project_4.bu}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_4.amount}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_4.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_actuals.project_4.month}}</strong></td>
                  </tr><tr>
                    <td><strong>{{top_key_projects_actuals.project_5.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_5.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_actuals.project_5.bu}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_5.amount}}</strong></td>
                    <td><strong>{{top_key_projects_actuals.project_5.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_actuals.project_5.month}}</strong></td>
                  </tr>
                </tbody>
                <tbody *ngIf="top_key_projects_open" [hidden]="hide_project_open">
                  <tr>
                    <td><strong>{{top_key_projects_open.project_1.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_1.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_open.project_1.bu}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_1.amount}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_1.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_open.project_1.month}}</strong></td>
                  </tr>
                  <tr>
                    <td><strong>{{top_key_projects_open.project_2.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_2.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_open.project_2.bu}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_2.amount}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_2.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_open.project_2.month}}</strong></td>
                  </tr><tr>
                    <td><strong>{{top_key_projects_open.project_3.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_3.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_open.project_3.bu}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_3.amount}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_3.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_open.project_3.month}}</strong></td>
                  </tr><tr>
                    <td><strong>{{top_key_projects_open.project_4.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_4.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_open.project_4.bu}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_4.amount}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_4.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_open.project_4.month}}</strong></td>
                  </tr><tr>
                    <td><strong>{{top_key_projects_open.project_5.oppertunity}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_5.account}}</strong></td>
                    <td style="text-align: left;"><strong>{{top_key_projects_open.project_5.bu}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_5.amount}}</strong></td>
                    <td><strong>{{top_key_projects_open.project_5.rank | uppercase}}</strong></td>
                    <td style="text-align: right;"><strong>{{top_key_projects_open.project_5.month}}</strong></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="row row-sm mg-b-20">
        <div class="col-lg-6 mg-t-20 mg-lg-t-0">
          <div class="card card-dashboard-five">
            <div class="card-header row">
              <div class="col-lg-6">
                <h6 class="card-title">Top 5 Key Accounts<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
              </div>
              <div class="col-lg-6">
                <div class="media" style="float: right;">
                  <div class="media-body">
                    <!-- <i class="fa fa-filter fa-3" aria-hidden="true"></i> -->
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="az-content-label az-content-label-sm mg-b-15">Order Value</div>
              <div id="chart-top-accounts" style="height: 250px;"></div>
            </div>
          </div>
        </div>
        <div class="col-lg-6 mg-t-20 mg-lg-t-0">
          <div class="card card-dashboard-five" style="height: 100%;">
            <div class="card-header row">
              <div class="col-lg-6">
                <h6 class="card-title">Lost Opportunity Overview<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
                <p class="card-text">{{buFilter}}/{{timeFilter}}</p>
              </div>
              <div class="col-lg-6">
                <div class="media" style="float: right;">
                  <div class="media-body">
                    <!-- <i class="fa fa-filter fa-3" aria-hidden="true"></i> -->
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body">
              <div class="az-content-label az-content-label-sm mg-b-15"></div>
              <div id="chart-pie-lost-opp" style="height: 250px;"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="row row-sm mg-b-20">
        <div class="col-lg-6 col-xl-6 mg-t-20 mg-lg-t-0">
          <div class="card card-table-one">
            <h6 class="card-title">Geo Wise Health<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th class="wd-45p">Country</th>
                    <th>Status</th>
                    <th>Order conversion</th>
                    <th>Say-Do</th>
                    <th>Run rate</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong>India</strong></td>
                    <td class="rag" style="background-color: #B0D08B;"></td>
                    <td><i style="color: red;" class="fas fa-caret-down"></i><strong>134</strong> (1.51%)</td>
                    <td>33.58%</td>
                    <td>15.47Mn</td>
                  </tr>
                  <tr>
                    <td><strong>LATAM</strong></td>
                    <td class="rag" style="background-color: #F0787B;"></td>
                    <td><i style="color: green;" class="fas fa-caret-up"></i><strong>290</strong> (3.30%)</td>
                    <td>9.22%</td>
                    <td>7.99Mn</td>
                  </tr>
                  <tr>
                    <td><strong>APAC</strong></td>
                    <td  class="rag" style="background-color: #F2C979;"></td>
                    <td><i style="color: red;" class="fas fa-caret-down"></i><strong>250</strong> (3.00%)</td>
                    <td>20.75%</td>
                    <td>2.40Mn</td>
                  </tr>
                  <tr>
                    <td><strong>Japan</strong></td>
                    <td  class="rag" style="background-color: #B0D08B;"></td>
                    <td><i style="color: green;" class="fas fa-caret-up"></i><strong>216</strong> (2.79%)</td>
                    <td>32.07%</td>
                    <td>15.09Mn</td>
                  </tr>
                  <tr>
                    <td><strong>USA</strong></td>
                    <td  class="rag" style="background-color: #F0787B;"></td>
                    <td><i style="color: green;" class="fas fa-caret-up"></i><strong>216</strong> (2.79%)</td>
                    <td>32.07%</td>
                    <td>15.09Mn</td>
                  </tr>
                  <tr>
                    <td><strong>EMEA</strong></td>
                    <td  class="rag" style="background-color: #B0D08B;"></td>
                    <td><i style="color: green;" class="fas fa-caret-up"></i><strong>216</strong> (2.79%)</td>
                    <td>32.07%</td>
                    <td>15.09Mn</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="col-lg-6 col-xl-6 mg-t-20 mg-lg-t-0">
          <div class="card card-table-one" style="height: 100%;">
            <h6 class="card-title">BU Performance<span *ngIf="currentBC">({{currentBC}}BC)</span></h6>
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th class="wd-45p">BU</th>
                    <th>Status</th>
                    <th>Order conversion</th>
                    <th>Say-Do</th>
                    <th>Run rate</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><strong>AIPF</strong></td>
                    <td class="rag" style="background-color: #B0D08B;"></td>
                    <td><i style="color: red;" class="fas fa-caret-down"></i><strong>134</strong> (1.51%)</td>
                    <td>33.58%</td>
                    <td>15.47Mn</td>
                  </tr>
                  <tr>
                    <td><strong>SMFG</strong></td>
                    <td class="rag" style="background-color: #B0D08B;"></td>
                    <td><i style="color: green;" class="fas fa-caret-up"></i><strong>290</strong> (3.30%)</td>
                    <td>9.22%</td>
                    <td>7.99Mn</td>
                  </tr>
                  <tr>
                    <td><strong>Display</strong></td>
                    <td class="rag" style="background-color: #F0787B;"></td>
                    <td><i style="color: red;" class="fas fa-caret-down"></i><strong>250</strong> (3.00%)</td>
                    <td>20.75%</td>
                    <td>2.40Mn</td>
                  </tr>
                  <tr>
                    <td><strong>Logistics</strong></td>
                    <td class="rag" style="background-color: #B0D08B;"></td>
                    <td><i style="color: green;" class="fas fa-caret-up"></i><strong>216</strong> (2.79%)</td>
                    <td>32.07%</td>
                    <td>15.09Mn</td>
                  </tr>
                  <tr>
                    <td><strong>JCCS</strong></td>
                    <td class="rag" style="background-color: #F2C979;"></td>
                    <td><i style="color: green;" class="fas fa-caret-up"></i><strong>216</strong> (2.79%)</td>
                    <td>32.07%</td>
                    <td>15.09Mn</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':pipelineModal}">
    <div class="modal-dialog" role="document" style="max-width: 1000px;max-height: 1000px;overflow-y: initial !important;">
      <div class="modal-content" style="margin-top: -20px;">
        <div class="modal-header">
          <!-- <h4 class="modal-title">Pipeline Analysis<br>{{buFilter}}/{{timeFilter}}</h4> -->
          <h4 class="modal-title">Pipeline Analysis({{buFilter}}/{{timeFilter}})</h4>
          <button _ngcontent-syb-c106="" type="button" aria-label="Close" class="close" (click)="closePipelineModal()">
            <span _ngcontent-syb-c106="" aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body" style="height: 80vh; overflow-y: auto;">
          <div class="row row-sm mg-b-20">
            <div class="col-lg-6 mg-t-20 mg-lg-t-0">
              <div class="card card-dashboard-five">
                <div class="card-header row">
                  <div class="col-lg-6">
                    <h6 class="card-title">Classify(Basis Rank)</h6>
                    <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
                  </div>
                  <div class="col-lg-6">
                    <div class="media" style="float: right;">
                      <!-- <div class="media-body">
                        <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;" (change)="toggleClassify()" #toggleClass>
                          <option value="rank">Rank</option>
                          <option value="classify">Classify</option>
                        </select>
                      </div> -->
                    </div>
                  </div>
                </div>
                <div class="card-body">
                  <div id="classify-pipeline-rank"  [hidden]="classify_rank_show" style="height: 400px;"></div>
                  <div id="classify-pipeline-class"  [hidden]="classify_class_show" style="height: 400px;"></div>
                </div>
              </div>
            </div>
            <div class="col-lg-6 mg-t-20 mg-lg-t-0">
              <div class="card card-dashboard-five">
                <div class="card-header row">
                  <div class="col-lg-6">
                    <h6 class="card-title">Geo</h6>
                    <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
                  </div>
                  <div class="col-lg-6">
                    <div class="media" style="float: right;">
                      <div class="media-body">
                        <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;" (change)="toggleGeo()" #toggleG>
                          <option value="rank">Rank</option>
                          <option value="classify">Classify</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="card-body">
                  <div id="geo-pipeline-rank" [hidden]="geo_rank_show" style="height: 400px;"></div>
                  <div id="geo-pipeline-class" [hidden]="geo_class_show" style="height: 400px;"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="row row-sm mg-b-20">
            <div class="col-lg-12 mg-t-20 mg-lg-t-0">
              <div class="card card-dashboard-five">
                <div class="card-header row">
                  <div class="col-lg-6">
                    <h6 class="card-title">Segment</h6>
                    <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
                  </div>
                  <div class="col-lg-6">
                    <div class="media" style="float: right;">
                      <div class="media-body">
                        <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;" (change)="toggleSegment()" #toggleSeg>
                          <option value="rank">Rank</option>
                          <option value="classify">Classify</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="card-body">
                  <div id="subproject-pipeline-rank" [hidden]="segment_rank_show" style="height: 400px;"></div>
                  <div id="subproject-pipeline-class" [hidden]="segment_class_show" style="height: 400px;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':fRankModal}">
    <div class="modal-dialog" role="document" style="max-width: 500px;max-height: 500px;">
      <div class="modal-content" style="margin-top: -20px;">
        <div class="modal-header">
          <!-- <h4 class="modal-title">Pipeline Analysis<br>{{buFilter}}/{{timeFilter}}</h4> -->
          <h4 class="modal-title">F Rank Analysis({{buFilter}}/{{timeFilter}})</h4>
          <button _ngcontent-syb-c106="" type="button" aria-label="Close" class="close" (click)="closeFRankModal()">
            <span _ngcontent-syb-c106="" aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="row row-sm mg-b-20">
            <div class="col-lg-12 mg-t-20 mg-lg-t-0">
              <div class="card card-dashboard-five">
                <div class="card-header row">
                  <div class="col-lg-6">
                    <h6 class="card-title">F Rank</h6>
                    <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
                  </div>
                  <div class="col-lg-6">
                    <div class="media" style="float: right;">
                      <!-- <div class="media-body">
                        <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;" (change)="toggleClassify()" #toggleClass>
                          <option value="rank">Rank</option>
                          <option value="classify">Classify</option>
                        </select>
                      </div> -->
                    </div>
                  </div>
                </div>
                <div class="card-body">
                  <div id="f-rank" style="height: 200px;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':salesModal}">
    <div class="modal-dialog" role="document" style="max-width: 600px;max-height: 500px;">
      <div class="modal-content" style="margin-top: -20px;">
        <div class="modal-header">
          <!-- <h4 class="modal-title">Pipeline Analysis<br>{{buFilter}}/{{timeFilter}}</h4> -->
          <h4 class="modal-title">Sales Breakdown({{buFilter}}/{{timeFilter}})</h4>
          <button _ngcontent-syb-c106="" type="button" aria-label="Close" class="close" (click)="closeSalesModal()">
            <span _ngcontent-syb-c106="" aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="row row-sm mg-b-20">
            <div class="col-lg-12 mg-t-20 mg-lg-t-0">
              <div class="card card-dashboard-five">
                <div class="card-header row">
                  <div class="col-lg-6">
                    <h6 class="card-title">New/Backlog</h6>
                    <p class="card-text">{{buFilter}}/{{timeFilter}}<br>Values in Million</p>
                  </div>
                  <div class="col-lg-6">
                    <div class="media" style="float: right;">
                      <div class="media-body">
                        <select class="btn btn-secondary dropdown-toggle" style="margin-left: 10px;margin-bottom: 10px;margin-right: 10px;" (change)="toggleSales()" #toggleSale>
                          <option value="overall">Overall</option>
                          <option value="rank">Ranks</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="card-body">
                  <div id="classify-sales" [hidden]="classify_sales_show" style="height: 400px;"></div>
                  <div id="classify-sales-rank" [hidden]="classify_sales_rank_show" style="height: 400px;"></div>
                  <!-- <div id="classify-pipeline-rank"  [hidden]="classify_rank_show" style="height: 200px;"></div>
                  <div id="classify-pipeline-class"  [hidden]="classify_class_show" style="height: 200px;"></div> -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':infoModal}">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Rank Info</h4>
        </div>
        <div class="modal-body">
          <div class="table-responsive">
            <table class="table table-striped mg-b-0">
              <thead>
                <tr>
                  <th>Stage</th>
                  <th>Rank</th>
                  <th>Probability</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">Suspect</th>
                  <td>F</td>
                  <td>0%</td>
                </tr>
                <tr>
                  <th scope="row">Contact/Prospect</th>
                  <td>E</td>
                  <td>10%</td>
                </tr>
                <tr>
                  <th scope="row">RFP Responded</th>
                  <td>D</td>
                  <td>30%</td>
                </tr>
                <tr>
                  <th scope="row">Shortlisted</th>
                  <td>C</td>
                  <td>50%</td>
                </tr>
                <tr>
                  <th scope="row">Final Negotiation</th>
                  <td>B</td>
                  <td>70%</td>
                </tr>
                <tr>
                  <th scope="row">Order in Process</th>
                  <td>A</td>
                  <td>90%</td>
                </tr>
                <tr>
                  <th scope="row">PO/LOI Received</th>
                  <td>S</td>
                  <td>100%</td>
                </tr>
                <tr>
                  <th scope="row">Order Recorded</th>
                  <td>Act</td>
                  <td>100%</td>
                </tr>
                <tr>
                  <th scope="row">Closed Lost</th>
                  <td>L</td>
                  <td>0%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">
          <button style="background-color: rgb(70, 121, 167);" type="button" class="btn btn-danger" 
                  (click)="closeOrderInfo()">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':SalesInfoModal}">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Rank Info</h4>
        </div>
        <div class="modal-body">
          <div class="table-responsive">
            <table class="table table-striped mg-b-0">
              <thead>
                <tr>
                  <th>Rank</th>
                  <th>Rank Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">A</th>
                  <td>Confirmed that sales will be recognized within the current half.</td>
                </tr>
                <tr>
                  <th scope="row">B</th>
                  <td>A high possibility of sales being recognized within the current half.</td>
                </tr>
                <tr>
                  <th scope="row">C</th>
                  <td>A moderate possibility of sales being recognized within the current half, but there is also a possibility of sales being delayed until the next fiscal half or later.</td>
                </tr>
                <tr>
                  <th scope="row">D</th>
                  <td>A possibility of accelerating sales being recognized within the current half.</td>
                </tr>
                <tr>
                  <th scope="row">E</th>
                  <td>A low possibility of accelerating sales being recognized within the current half.</td>
                </tr>
                <tr>
                  <th scope="row">Act</th>
                  <td>Sales have been recognized and recorded.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">
          <button style="background-color: rgb(70, 121, 167);" type="button" class="btn btn-danger" 
                  (click)="closeSalesInfo()">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
